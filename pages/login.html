<!DOCTYPE html>
<html lang="zh">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>登录凡客</title>
	<link rel="shortcut icon" href="../favicon.ico"  type="image/x-icon"/>
	<link rel="stylesheet" type="text/css" href="../css/login.css"/>
</head>
<body>
		<div id="header" class="container">
			<img src="../images/logo_new.jpg" >
		</div>
	<div id="main" class="container clear">
		<img src="../images/login_newlogo.jpg" class="l">
		<div class="login l">
			<div class="login_top clear">
				<span class="l">用户登录</span>
				<span class="r">我没账号现在就去&nbsp;<a href="./register.html">注册</a></span>
			</div>
			<form action="" method="">
				<span name="nameTip"></span>
				<label>用户名:<input type="text" name="username" placeholder="请输入用户名" maxlength="16" /></label><br>
				<span name="pwdTip"></span>
				<label>密&ensp;&ensp;码:<input type="password" name="userpwd" placeholder="请输入登录密码" maxlength="16" /></label><br>
				<input type="checkbox" name="rem_login"  class="clear"/>记住用户名和密码<span class="toTel r">手机动态密码登录<a href="javascript:;">&gt;</a></span>
				
				<button type="submit" name="submit">立即登录</button>
			</form>
	    </div>
    </div>
	<script src="../js/cookie.js" type="text/javascript" charset="utf-8"></script>
		<script src="../js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
				$('form').submit(function(e){
				          e.preventDefault();
				
				          let username = $('[name="username"]').val();
				          let userpwd = $('[name="userpwd"]').val();
						  
						  $('[name="username"]').keyup(function(){
							  let username = $('[name="username"]').val();
							  let userpwd = $('[name="userpwd"]').val();
							  if(username==""){
							  		$('[name="nameTip"]').html("！用户名不能为空")
							  }else{
								  $('[name="nameTip"]').html("")
							  }
						  })
						  
						  $('[name="userpwd"]').keyup(function(){
							  let username = $('[name="username"]').val();
							  let userpwd = $('[name="userpwd"]').val();
							  if(userpwd==""){
							  	$('[name="pwdTip"]').html("！密码不能为空")
							  }else{
								 $('[name="pwdTip"]').html("") 
							  }
						  })
						  
						  if(username==""){
						  		$('[name="nameTip"]').html("！用户名不能为空")
						  }else{
						  		 $('[name="nameTip"]').html()
						  }
						  if(userpwd==""){
						  	$('[name="pwdTip"]').html("！密码不能为空")
						  }else{
						  	  $('[name="pwdTip"]').html() 
						  }
						  
						 
						 
						 
						 
						  
						  
				          $.ajax({
				              url:'../server/goods_login.php',
				              type:'post',
				              data:{userName:username , userPwd:userpwd},
				              dataType:'json',
				              success:function(res){
				                 if(res == '1'){
				                   window.alert('您登录成功,点击返回');
								  let str = decodeURIComponent(window.location.search);
								  str = str.substr(1);
				                   window.location.href = str;
								   
								   setCookies('login' , 1 , 7*24*60*60);
								   
				                 }else if( res == '0'){
				                  window.alert('您登录失败,请继续检查用户名或密码');
				                 }
				              }
				          })
				
				      })
				    
					//记住登录名和密码
					var remname = document.querySelector('[name="username"]');
					var rempsw = document.querySelector('[name="userpwd"]');
					var remember = document.querySelector('[name="rem_login"]');
					if (localStorage.getItem('username')&&localStorage.getItem('userpsw')) {
					    remname.value = localStorage.getItem('username');
					    rempsw.value = localStorage.getItem('userpsw');
					    remember.checked = true;
					}
					remember.addEventListener('change', function() {
					    if (this.checked) {
					        localStorage.setItem('username', remname.value)
					        localStorage.setItem('userpsw', rempsw.value)
					    } else {
					        localStorage.removeItem('username');
													 localStorage.removeItem('userpsw');
					    }
					})
					
		</script>	
						
</body>
</html>