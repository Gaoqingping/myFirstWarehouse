"use strict";$(".drag-wrapper").draggable(),$(".resize-item").resizable();var cateArr=JSON.parse(localStorage.getItem("cart"));function setPage(t){var e=0,a=0,c=0,o="";t.forEach(function(t){o+='\n\t\t\t\t   <div class="cart-item">\n                       <div class="p-checkbox">\n                           <input type="checkbox" name="checked" id="" class="j-checkbox" goods_id="'.concat(t.goods_id,'" ').concat(!0===t.buy?"checked":"",'>\n                       </div>\n                       <div class="p-goods">\n                           <div class="p-img">\n                               <img src="').concat(t.goods_small_logo,'" alt="" style="width:100px;height:100px">\n                           </div>\n                           <div class="p-msg">').concat(t.goods_name,'</div>\n                       </div>\n                       <div class="p-price">').concat(t.goods_price,'</div>\n                       <div class="p-num">\n                           <div class="quantity-form">\n   \t\t\t\t<button name="lost" class="decrement" goods_id="').concat(t.goods_id,'" ').concat(1==t.num?"disabled":"",'>-</button>\n                               <input type="text" class="itxt" value="').concat(t.num,'">\n   \t\t\t\t<button name="odd"  class="increment" goods_id="').concat(t.goods_id,'" ').concat(t.num==t.goods_number?"disabled":"",'>+</button>\n                           </div>\n                       </div>\n                       <div class="p-sum">￥ ').concat(parseFloat(t.num*t.goods_price).toFixed(2),'</div>\n                       <div class="p-action"><a href="javascript:;" goods_id="').concat(t.goods_id,'" name="del">删除</a></div>\n                   </div>'),$(".cart-item-list").html(o),!0===t.buy&&(a++,e+=t.num,c+=t.num*t.goods_price)});var r="";r+='\n\t\t\t    <div class="select-all">\n\t                    <input type="checkbox" name="no" id="all" class="checkall">全不选\n\t                </div>\n\t                <div class="operation">\n\t                    <a href="javascript:;" class="remove-batch" name="not"> 删除选中的商品</a>\n\t                    <a href="javascript:;" class="clear-all" name="clear-all">清空购物车</a>\n\t                </div>\n\t                <div class="toolbar-right">\n\t                    <div class="amount-sum">已经选<strong>'.concat(a,"</strong>种商品 共<em>").concat(e,'</em>件</div>\n\t                    <div class="price-sum">总价： ￥<em>').concat(parseFloat(c).toFixed(2),'</em></div>\n\t                    <div class="btn-area">去结算</div>\n\t                </div>\n\t\t\t   '),$(".cart-floatbar").html(r)}setPage(cateArr);var oDiv=document.querySelector(".cart-warp");oDiv.addEventListener("click",function(e){if("checkall"===e.target.getAttribute("name")&&($(".j-checkbox").prop("checked",$('[name="checkall"]').prop("checked")),$('[name="checkall"]').prop("checked")?cateArr.forEach(function(t){t.buy=!0}):cateArr.forEach(function(t){t.buy=!1})),"no"===e.target.getAttribute("name")&&cateArr.forEach(function(t){t.buy=!1}),"not"===e.target.getAttribute("name")&&(console.log(123),cateArr.forEach(function(t,e){1==t.buy&&(cateArr.splice(e,1),$(".cart-item")[e].remove())})),"checked"===e.target.getAttribute("name")){var a=e.target.getAttribute("goods_id");cateArr.forEach(function(t){t.goods_id===a&&(t.buy=$(e.target).prop("checked"))})}if("del"===e.target.getAttribute("name")&&confirm("确定将此商品移出购物车？")){var c=e.target.getAttribute("goods_id");cateArr.forEach(function(t,e){t.goods_id===c&&(cateArr.splice(e,1),$(".cart-item")[e].remove())})}if("odd"===e.target.getAttribute("name")){var o=e.target.getAttribute("goods_id");cateArr.forEach(function(t,e){t.goods_id===o&&t.num++,t.num==t.goods_number&&alert("抱歉,库存量不足")})}if("lost"===e.target.getAttribute("name")){var r=e.target.getAttribute("goods_id");cateArr.forEach(function(t,e){t.goods_id===r&&t.num--})}"clear-all"===e.target.getAttribute("name")&&(cateArr.forEach(function(t,e){cateArr.length=0}),$(".cart-item").remove()),setPage(cateArr),localStorage.setItem("cart",JSON.stringify(cateArr))});